{
    "collab_server" : "",
    "contents" : "---\ntitle: \"IA1\"\nauthor: \"Jake VanCampen\"\ndate: \"`r format(Sys.Date(), '%b %d %Y')`\"\noutput: html_document\n---\n\n\n```{r}\nknitr::opts_chunk$set(message=FALSE, warning = FALSE)\n```\n\n\n## Enriched diet affects zebrafish size\n\nTo study the effects of an enriched diet on mean zebrafish size,\n200 freshly hatched zebrafish were taken from the same clutch and randomly assigned to an enriched or a control diet (unenriched). The diet was administered for two months at which point the standard length (mm) and mass (kg) of each fish was measured. Results were compiled in a tab-separated file containing the following columns: \"Individual\", \"Diet\", \"SL\", and \"Weight.\"\n\n\nThe following are the hypothesis to be tested in this experiment: \n\n\n\n$$ H{_0} \\text{: Feeding zeebrafish an enriched diet will not affect their mean size after two months}$$ \n$$ H{_A} \\text{: Feeding zebrafish an enriched diet will affect their mean size after two months} $$\n\n\n\n### Exploratory Data Analysis\n\n\n```{r}\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(ggpubr)\nlibrary(knitr)\nzfish_raw <- read_tsv('zfish_diet_IA.tsv')\nhead(zfish_raw)\n```\n\n\n\n### Histograms \n\nLet's take a look at some of the ways the data are distributed. First we can look at histograms of continuous variables weight and standard length\n\n```{r}\nggplot(zfish_raw, aes(fill = Diet))+ \n  geom_histogram(aes(Weight))+ \n  facet_wrap(~Diet)+\n  xlab('Weight (kg)')+\n  ggtitle('Weight Distribution by Diet')\n\n\nggplot(zfish_raw, aes(fill = Diet))+ \n  geom_histogram(aes(SL))+ \n  facet_wrap(~Diet)+ \n  xlab('Standard Length (cm)') + \n  ggtitle('Standard Length Distribution by Diet') \n\n```\n\n\nThere appears to be a large outlier in the data that is obscuring the distribution of both SL, and Weight. I will remove the outlier from the dataset as shown below: \n\n```{r}\nzfish_correct <- zfish_raw %>% \n  filter(., Weight < 4 & SL < 20)\n\n\n# total SL hist colored by diet\ndt_n <- ggplot(zfish_correct, aes(SL, fill = Diet))+\n            geom_histogram(binwidth = 0.05)\n\n\n# SL hist faceted by diet\ndt <- ggplot(zfish_correct, aes(SL, fill = Diet)) + \n          geom_histogram(binwidth = 0.05)+ \n          facet_grid(Diet~.)+\n          xlab('Standard Length (cm)') + \n  theme(\n  strip.background = element_blank(),\n  strip.text.x = element_blank(),\n  strip.text.y = element_blank()\n)\n\n\n# total weight hist colored by diet\nwt_n <- ggplot(zfish_correct, aes(Weight, fill = Diet)) +\n            geom_histogram(binwidth = 0.01)+\n            theme(axis.title.y = element_blank())\n  \n# weight hists faceted by diet\nwt <- ggplot(zfish_correct, aes(Weight, fill = Diet)) + \n  geom_histogram(aes(Weight, fill = Diet), binwidth = 0.007) + \n  facet_grid(Diet~.)+\n  xlab('Weight (kg)') + \n  theme(\n  strip.background = element_blank(),\n  strip.text.x = element_blank(),\n  strip.text.y = element_blank(),\n  axis.title.y = element_blank()\n)\n\n\n# group figures\nggarrange(dt_n, wt_n, common.legend = TRUE, legend = 'right') %>% annotate_figure(., top = text_grob(\"Histograms of continuous variables\"))\n\nggarrange(dt, wt, common.legend = TRUE, legend = 'right') %>% annotate_figure(., top = text_grob(\"Histograms of continuous variables split by diet\"))\n      \n```\n\n\nOkay that certainly changed the histograms! These data seem to be fairly normally distributed. The histograms of continuous variables split by diet show a positive shift in both continuous variables for the enriched diet compared to the control, let's do some statistics to back this up!\n\n\n### Boxplots\n\nFirst similar comparisons will be made using boxplots.\n\n```{r}\nbp_d <- ggplot(zfish_correct, aes(Diet, SL, fill = Diet))+ \n  geom_boxplot()\n\nbp_w <- ggplot(zfish_correct, aes(Diet, Weight, fill = Diet))+ \n  geom_boxplot()\n\nggarrange(bp_d, bp_w, common.legend = TRUE, legend = 'right')  %>% annotate_figure(., top = text_grob(\"Boxplots of zebrafish measurements by diet\"))\n```\n\nAgain we see the overall increase in both metrics with an enriched diet as compared to the control.\n\n\n### Summary statistics\n\nAnd a summary table to compare relevant statistics:\n```{r}\nzfish_correct %>% \n  group_by(Diet) %>%\n  summarise_at(vars(SL, Weight), c('mean', 'median', 'sd')) %>% \n  kable(., align = 'c', caption = 'Summary statistics for zebra fish measuremnets by diet')\n\n```\n\n\n### T Test\n\nBecause the data look to be normally distributed, appear to have equal variances (sd[control] ~= sd[diet]), and occur as independant observations, the distributional assumptions are met to perform a parametric T Test. The T Test will test a difference in the means of the Control and Enriched treatments for both weight, and standard length.\n\n\n```{r}\n\n# T tests for each \nsl_T <- t.test(zfish_correct$SL ~ zfish_correct$Diet)\nwt_T <- t.test(zfish_correct$Weight ~ zfish_correct$Diet)\n\n\n# format for reporting t test\nt.report <- function(tt){\n  tvalue <- tt$statistic %>% formatC(digits = 2, format = \"f\")\n  pvalue <- tt$p.value %>% formatC(digits = 2, format = \"E\")\n  if (round(tt$parameter, 0) == tt$parameter) {\n    df <- tt$parameter\n  } else {\n    df <- formatC(tt$parameter, digits = 2, format = \"f\")\n  }\n  if (tt$p.value < 0.0005) {\n    pvalue <- \" < 0.001\" \n  } else { \n    if (tt$p.value < 0.005) {\n      pvalue <- paste0(\" = \",tt$p.value %>% formatC(., digits = 3, format = \"f\"))\n    } else {\n      pvalue <- paste0(\" = \",tt$p.value %>% formatC(., digits = 2, format = \"f\"))\n    }\n    } \n  paste0(\"*t*(\",df,\") = \",tvalue, \", *p*\", pvalue)\n  }\n```\n\n\nHere it is shown that zebrafish have a significantly higher standard length when fed an enriched diet as compared to a normal diet `r t.report(sl_T)`, and have a significantly higher weight when fed an enriched diet as compared to a normal diet `r t.report(wt_T)`, and the null hypothesis can be rejected for both continuous variables.\n\n\n### Non-parametric T test\n\nThe hypothesis testing can be done using a non-parametric parameter estimation (calculated by resampling of the means) and then performing a T-test. This resampling will cooerce the distribution of the parameter estimate into normality (if the data are not already normally distributed) before performing hypothesis tests, such that our confidence interval about the the hypothesis test is valid. \n\n```{r}\n\nsl <- zfish_correct$SL\nwt <- zfish_correct$Weight\n\n# bootstrap_means func\nboot <- function(x) {\nz <- NULL \nfor (i in 1:1000) {\n  xboot <- sample(x, 20, replace = T)\n  z[i] <- mean(xboot)\n}\nMean <- mean(z)\nSEM <- sd(z)\nCI <- quantile(z,c(0.025,0.975))\nreturn(list(tbl_df(data.frame('Mean' = Mean,\n                  'SEM' = SEM, \n                  bm.lower.ci = CI[1], \n                  bm.upper.ci = CI[2])), tbl_df(data.frame(z))))\n}\n\nmeans <- boot(sl)[2]\nmeans$z\n\n```\n\n\n\n\n\n\n\n",
    "created" : 1508777878722.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4000382715",
    "id" : "E62A64F9",
    "lastKnownWriteTime" : 1508791623,
    "last_content_update" : 1508791623065,
    "path" : "~/Documents/Bi610/IA1/IA1.Rmd",
    "project_path" : "IA1.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}